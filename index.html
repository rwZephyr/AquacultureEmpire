<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Aquaculture Empire</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <header id="topHeader">
    <div class="container">
    <!-- Top bar: site nav on left, cash on right -->
    <div id="topBar">
      <div class="top-left">
        <strong>Site:</strong>
        <span id="siteName">-</span>
        <button onclick="previousSite()">⟵</button>
        <button onclick="nextSite()">⟶</button>
        <button onclick="buyNewSite()">+ New Site</button>
      </div>
      <div class="top-right">
        <div><strong>Cash:</strong> $<span id="cashCount">0</span></div>
        <div>
          <strong>Date:</strong>
          <span id="dateDisplay">Spring 1, Year 1</span>
          <span id="pauseButton" class="time-btn" title="Pause" onclick="pauseTime()">⏸️</span>
          <span id="playButton" class="time-btn" title="Resume" onclick="resumeTime()">▶️</span>
        </div>
        <button onclick="openMarketReport()">Market Report</button>
        <button onclick="openShipyard()">Shipyard</button>
      </div>
      </div>
    </div>
  </header>

  <main id="mainLayout">
      <aside id="rightSidebar">
        <!-- Status cards -->
        <div id="cardContainer" class="cardContainer">
          <div id="feedOverviewCard" class="logisticsCard">
            <h2>Feed Storage</h2>
            <div class="progressBar"><div id="feedProgress" class="progress"></div></div>
            <div><span id="totalFeed">0</span> / <span id="totalFeedCapacity">0</span> kg</div>
          </div>
          <div id="bargeCard" class="bargeCard">
            <h2>Barge Status</h2>
            <div>
              <button class="staff-button" onclick="previousBarge()">⟵</button>
              Barge <span id="bargeIndex">1</span>/<span id="bargeCount">1</span>
              <button class="staff-button" onclick="nextBarge()">⟶</button>
            </div>
            <div>Barge Tier: <span id="bargeTierName">Small</span></div>
            <div>Feeders: <span id="bargeFeedersUsed">0</span>/<span id="bargeFeederLimit">0</span> (Max Tier <span id="bargeMaxFeederTier">0</span>)</div>
            <div>Feed: <span id="bargeFeed">0</span> / <span id="bargeFeedCapacity">0</span> kg</div>
            <div>Silo Capacity: <span id="bargeSiloCapacity">0</span> kg</div>
            <div>Staff: <span id="bargeStaffCount">0</span> / <span id="bargeStaffCapacity">0</span></div>
            <div>Unassigned: <span id="bargeStaffUnassigned">0</span></div>
            <div id="bargeHousingInfo"></div>
            <button class="staff-button" onclick="buyMaxFeed()">Refill Feed</button>
            <button class="staff-button" onclick="openBargeUpgradeModal()">Barge Upgrades</button>
          </div>
          <div id="staffCard" class="staffCard">
            <h2>Staffing</h2>
            <div>Total: <span id="staffTotal">0</span> / <span id="staffCapacity">0</span></div>
            <div>Unassigned: <span id="staffUnassigned">0</span></div>
            <div class="staff-buttons">
              <button class="staff-button" onclick="hireStaff()">&#x2795; Hire ($500)</button>
              <button class="staff-button" onclick="fireStaff()">&#x1f5d1; Fire</button>
            </div>
            <div class="staff-role">
              <span>Feeders:</span>
              <div class="role-controls">
                <button class="staff-button" onclick="unassignStaff('feeder')" aria-label="Remove feeder">&#x2212;</button>
                <span id="staffFeeders">0</span>
                <button class="staff-button" onclick="assignStaff('feeder')" aria-label="Add feeder">&#x2b;</button>
              </div>
            </div>
            <div class="staff-role">
              <span>Harvesters:</span>
              <div class="role-controls">
                <button class="staff-button" onclick="unassignStaff('harvester')" aria-label="Remove harvester">&#x2212;</button>
                <span id="staffHarvesters">0</span>
                <button class="staff-button" onclick="assignStaff('harvester')" aria-label="Add harvester">&#x2b;</button>
              </div>
            </div>
            <div class="staff-role">
              <span>Feed Managers:</span>
              <div class="role-controls">
                <button class="staff-button" onclick="unassignStaff('feedManager')" aria-label="Remove feed manager">&#x2212;</button>
                <span id="staffManagers">0</span>
                <button class="staff-button" onclick="assignStaff('feedManager')" aria-label="Add feed manager">&#x2b;</button>
              </div>
            </div>
          </div>
          <div id="tipsCard" class="tipsCard">
            <h2>Operational Tips</h2>
            <div id="operationalTips"></div>
          </div>
        </div>

    <div id="shop" class="shopPanel">
      <h2>Shop</h2>
      <div id="feedPurchaseButtons">
        <button onclick="buyFeed(20)">+20kg Feed</button>
        <button onclick="buyFeed(100)">+100kg Feed</button>
        <button onclick="buyMaxFeed()">Buy Max</button>
      </div>




      <div class="shopSection" onclick="toggleSection('devMenu')">Dev Menu</div>
      <div id="devMenu" class="shopSection-content">
        <button onclick="addDevCash()">Add $100k</button>
        <button onclick="devHarvestAll()">Harvest All Pens</button>
        <button onclick="devRestockAll()">Restock All (Free)</button>
        <button onclick="devAddBiomass()">+10kg Biomass (Pen)</button>
      </div>

      <div id="licenseShop"></div>
      <div id="statusMessages"></div>
      </div>
    </aside>
    <section id="pensSection">
        <!-- Harvest info (single-pen harvest preview) -->
        <div id="harvestInfo" class="harvestInfo"></div>

    <!-- Pen grid -->
    <div id="penGrid">
      <h2>Pen Status</h2>
      <div id="newPenControls" class="newPenControls">
        <label for="newPenBargeSelect">Add Pen to Barge:</label>
        <select id="newPenBargeSelect" onchange="updateSelectedBargeDisplay()"></select>
        <button onclick="buyNewPen(document.getElementById('newPenBargeSelect').value)">+ Pen</button>
        <span id="selectedBargeDisplay"></span>
      </div>
        <div id="penGridContainer" class="grid">
        </div>
      <template id="penCardTemplate">
        <div class="penCard">
          <h3 class="pen-name"></h3>
          <div class="stat">Species: <span class="pen-species"></span></div>
          <div class="stat">Fish: <span class="pen-fish"></span></div>
          <div class="stat">Avg Weight: <span class="pen-avg"></span> kg</div>
          <div class="stat">Biomass: <span class="pen-biomass"></span> kg</div>
          <div class="stat">Feeder: <span class="pen-feeder"></span></div>
          <button class="feed-btn">Feed</button>
          <button class="restock-btn">Restock</button>
          <button class="upgrade-btn">Upgrade Feeder</button>
        </div>
      </template>
    </div>
    </section>
  </main>

  <footer id="bottomSection">
    <div class="container">
      <div id="vesselGridContainer" class="vesselGrid">
      </div>
      <template id="vesselCardTemplate">
        <div class="vesselCard">
          <h3 class="vessel-name"><span class="name-text"></span><span class="rename-icon" title="Rename">&#9998;</span></h3>
          <div class="stat">Tier: <span class="vessel-tier"></span></div>
          <div class="stat">Location: <span class="vessel-location"></span></div>
          <div class="stat">Status: <span class="vessel-status"></span></div>
          <div class="stat harvest-species"></div>
          <div class="progressBar"><div class="progress vessel-progress"></div></div>
          <div class="stat"><span class="vessel-load"></span> / <span class="vessel-capacity"></span> kg</div>
          <button class="harvest-btn">Harvest</button>
          <button class="move-btn">Move Vessel</button>
          <button class="sell-btn">Sell Cargo</button>
          <button class="upgrade-btn">Vessel Upgrades</button>
          <button class="cancel-btn">Cancel</button>
        </div>
      </template>
    </div>
  </footer>

  <!-- Modals -->
    <div id="modal">
      <div id="modalContent">
        <p id="modalText"></p>
        <button onclick="closeModal()">OK</button>
      </div>
    </div>
    <div id="restockModal">
      <div id="restockModalContent">
        <h2>Choose Species</h2>
        <div id="restockOptions"></div>
        <button onclick="closeRestockModal()">Cancel</button>
      </div>
    </div>
    <div id="harvestModal">
      <div id="harvestModalContent">
        <h2>Start Harvest</h2>
        <div>
          <label for="harvestPenSelect">Pen:</label>
          <select id="harvestPenSelect"></select>
        </div>
        <div>Max: <span id="harvestMax">0</span> kg</div>
        <input type="number" id="harvestAmount" min="0" step="0.01">
        <button onclick="confirmHarvest()">Start Harvest</button>
        <button onclick="closeHarvestModal()">Cancel</button>
      </div>
    </div>
    <div id="sellModal">
      <div id="sellModalContent">
        <h2>Select Market</h2>
        <div id="sellOptions"></div>
        <button onclick="closeSellModal()">Cancel</button>
      </div>
    </div>
    <div id="moveModal">
      <div id="moveModalContent">
        <h2>Select Destination</h2>
        <div id="moveOptions"></div>
        <button onclick="closeMoveModal()">Cancel</button>
      </div>
    </div>
    <div id="renameModal">
      <div id="renameModalContent">
        <h2>Rename Vessel</h2>
        <input type="text" id="renameInput">
        <button onclick="confirmRename()">Rename</button>
        <button onclick="closeRenameModal()">Cancel</button>
      </div>
    </div>

    <div id="bargeUpgradeModal">
      <div id="bargeUpgradeModalContent">
        <h2>Barge Upgrades</h2>
        <div id="bargeUpgradeMessage" class="barge-alert" style="display:none"></div>
        <button class="staff-button" onclick="buyFeedStorageUpgrade()">Upgrade Storage</button>
        <button class="staff-button" onclick="upgradeBarge()">Upgrade Barge</button>
        <button class="staff-button" onclick="upgradeStaffHousing()">Upgrade Housing</button>
        <button class="staff-button" onclick="buyNewPen()">+ Pen</button>
        <button class="staff-button" onclick="buyNewBarge()">Buy Barge</button>
        <div id="storageUpgradeInfo"></div>
        <div id="bargeUpgradeInfo"></div>
        <div id="bargePurchaseInfo"></div>
        <div id="penPurchaseInfo"></div>
        <button class="staff-button" onclick="closeBargeUpgradeModal()">Close</button>
      </div>
    </div>
    <div id="shipyardModal">
      <div id="shipyardModalContent">
        <button class="close-shipyard-btn" onclick="closeShipyard()">Back</button>
        <h2>Shipyard</h2>
        <div id="shipyardList"></div>
        <button id="openCustomBuildBtn" onclick="openCustomBuild()">Custom Build</button>
        <div id="customBuildPage" class="custom-build-page" style="display:none">
          <button class="close-shipyard-btn" onclick="backToShipyardList()">Back</button>
          <h3>Custom Build</h3>
          <div>
            <label for="buildClassSelect">Class:</label>
            <select id="buildClassSelect" onchange="updateCustomBuildStats()"></select>
          </div>
          <div id="buildStats"></div>
          <div>
            <label for="buildNameInput">Name:</label>
            <input type="text" id="buildNameInput">
          </div>
          <div>Cost: $<span id="buildCost"></span></div>
          <button onclick="confirmCustomBuild()">Purchase</button>
        </div>
      </div>
    </div>
    <div id="marketReportPage" class="market-report-page">
      <button id="closeMarketReportBtn" class="close-report-btn" onclick="closeMarketReport()">Back</button>
      <!-- Market tables and future graph placeholder will be injected into this container -->
      <div id="marketReportContent" class="market-report"></div>
    </div>
  <script type="module" src="script.js"></script>
</body>
</html>
